Object subclass: #Mensaje	instanceVariableNames: 'ubicacion'	classVariableNames: ''	package: 'Las Hormigas 2, la secuela new'!!Mensaje methodsFor: 'accessing' stamp: '6/24/2025 12:00'!ubicacion	^ ubicacion! !!Mensaje methodsFor: 'accessing' stamp: '6/24/2025 12:00'!ubicacion: anObject	ubicacion := anObject! !!Mensaje methodsFor: 'aux' stamp: '6/24/2025 14:07'!esMensajeColonia  ^true! !!Mensaje methodsFor: 'initialization' stamp: '6/26/2025 02:21'!initialize: unaCasilla	ubicacion := Point x:unaCasilla ubicacion x y: unaCasilla ubicacion y.! !!Mensaje methodsFor: 'Propias del tipo' stamp: '6/26/2025 01:06'!procesarMensajePor:unaReina	^self subclassResponsibility! !BorderedMorph subclass: #MundoVisual	instanceVariableNames: 'miSimulacion celdas botonTurno botonPausa botonCerrar contadorTurno'	classVariableNames: ''	package: 'Las Hormigas 2, la secuela new'!!MundoVisual methodsFor: 'initialization' stamp: '2/2/2026 16:34'!initializeCon: unaSimulacion    | mundoModelo filaMorph ancho alto |    super initialize.    miSimulacion := unaSimulacion.    mundoModelo := miSimulacion mundo.    ancho := mundoModelo ancho.    alto := mundoModelo alto.    "Configuración de la Ventana"    self layoutPolicy: TableLayout new.    self listDirection: #topToBottom.    self color: Color black.    self hResizing: #shrinkWrap.    self vResizing: #shrinkWrap.    self position: 50@50.    "1. Crear la Grilla de Celdas"    celdas := Array new: alto.    1 to: alto do: [:y |        celdas at: y put: (Array new: ancho).        filaMorph := Morph new layoutPolicy: TableLayout new; listDirection: #leftToRight; color: Color transparent; hResizing: #shrinkWrap; vResizing: #shrinkWrap.                1 to: ancho do: [:x |            | nuevaCelda |            nuevaCelda := CeldaVisual crearEn: x@y.            (celdas at: y) at: x put: nuevaCelda.            filaMorph addMorph: nuevaCelda.        ].        self addMorph: filaMorph.    ].    "2. Crear Botonera"    self agregarBotones.! !!MundoVisual methodsFor: 'stepping and presenter' stamp: '2/2/2026 20:05'!stepTime    ^ 500 "Milisegundos entre turnos (medio segundo)"! !!MundoVisual methodsFor: 'stepping and presenter' stamp: '2/2/2026 21:29'!step	miSimulacion ejecutarTurno.	self actualizarVista! !!MundoVisual methodsFor: 'user-interface' stamp: '2/2/2026 16:01'!toggleStepping    self isStepping         ifTrue: [ self stopStepping ]        ifFalse: [ self startStepping ]! !!MundoVisual methodsFor: 'user-interface' stamp: '2/2/2026 19:47'!agregarBotones    | botonera |    botonera := Morph new layoutPolicy: TableLayout new; listDirection: #leftToRight; color: Color transparent; hResizing: #shrinkWrap; vResizing: #shrinkWrap; cellInset: 10.        "Boton Pasar Turno"    botonTurno := BotonAccion new.    botonTurno label: 'PASAR TURNO'; color: Color darkGray.    botonTurno mouseAction: [ self step. self stopStepping ].        "Boton Pausar/Continuar"    botonPausa := BotonAccion new.    botonPausa label: 'PAUSAR/CONTINUAR'; color: Color darkGray.    botonPausa mouseAction: [ self toggleStepping ].        "Boton Cerrar"    botonCerrar := BotonAccion new.    botonCerrar label: 'CERRAR'; color: Color red.    botonCerrar mouseAction: [ self delete ].	 contadorTurno := Contador new.    contadorTurno unaSimulacion: miSimulacion.	    botonera addMorph: botonTurno.    botonera addMorph: botonPausa.    botonera addMorph: botonCerrar.	 botonera addMorph: contadorTurno.        self addMorph: botonera.! !!MundoVisual methodsFor: 'user-interface' stamp: '2/2/2026 21:29'!actualizarVista	| objeto celda fondo |	1 to: miSimulacion mundo alto do: [ :y |		1 to: miSimulacion mundo ancho do: [ :x |			objeto := miSimulacion mundo objetoEn: x @ y.			fondo := (miSimulacion mundo casillas at: y) at: x.			celda := (celdas at: y) at: x.			celda dibujar: objeto sobre: fondo ] ].	self changed! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!MundoVisual class	instanceVariableNames: ''!!MundoVisual class methodsFor: 'as yet unclassified' stamp: '2/2/2026 16:05'!ver: unaSimulacion    ^self new initializeCon: unaSimulacion! !Object subclass: #Casilla	instanceVariableNames: 'ubicacion'	classVariableNames: ''	package: 'Las Hormigas 2, la secuela new'!!Casilla methodsFor: 'accessing' stamp: '6/24/2025 11:59'!ubicacion	^ ubicacion! !!Casilla methodsFor: 'accessing' stamp: '6/24/2025 11:59'!ubicacion: anObject	ubicacion := anObject! !!Casilla methodsFor: 'aux' stamp: '6/24/2025 14:05'!esCasilla   ^true! !!Casilla methodsFor: 'aux' stamp: '6/24/2025 14:06'!esColonia   ^false! !!Casilla methodsFor: 'aux' stamp: '6/24/2025 14:58'!esFuenteDeComida  ^false! !!Casilla methodsFor: 'initialization' stamp: '6/26/2025 01:51'!initializeEn: unaUbicacion	ubicacion := Point x: unaUbicacion x y: unaUbicacion y.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Casilla class	instanceVariableNames: ''!!Casilla class methodsFor: 'construction' stamp: '6/26/2025 01:48'!crearEn: unaPosicion	^self new		initializeEn:unaPosicion.! !Object subclass: #Mundo	instanceVariableNames: 'ancho alto casillas'	classVariableNames: ''	package: 'Las Hormigas 2, la secuela new'!!Mundo methodsFor: 'accessing' stamp: '6/24/2025 12:01'!ancho	^ ancho! !!Mundo methodsFor: 'accessing' stamp: '6/24/2025 12:01'!ancho: anObject	ancho := anObject! !!Mundo methodsFor: 'accessing' stamp: '6/24/2025 12:01'!alto	^ alto! !!Mundo methodsFor: 'accessing' stamp: '6/24/2025 12:01'!alto: anObject	alto := anObject! !!Mundo methodsFor: 'accessing' stamp: '6/24/2025 12:01'!casillas	^ casillas! !!Mundo methodsFor: 'accessing' stamp: '6/24/2025 17:45'!casillas: anObject	casillas := anObject! !!Mundo methodsFor: 'Propias del tipo' stamp: '6/26/2025 01:59'!colonias	"Retorna una colección de todas las colonias en el mundo"	| colColias |	colColias := OrderedCollection new.	self casillas do: [ :fila |		fila do: [ :c | c esColonia ifTrue: [ colColias add: c ] ] ].	^colColias! !!Mundo methodsFor: 'Propias del tipo' stamp: '6/26/2025 01:42'!iniciarMundo	self colonias do: [ :colonia | colonia activarRutinaColonial: self ].	self verificarGuerras! !!Mundo methodsFor: 'Propias del tipo' stamp: '6/25/2025 14:13'!estaDentroDeLimites: ubicacion^ (ubicacion x between: 1 and: ancho) and:  (ubicacion y between: 1 and: alto)! !!Mundo methodsFor: 'Propias del tipo' stamp: '2/2/2026 20:57'!iniciarGuerraEntre: colonia1 Y: colonia2	"Implementa el sistema de combate con rotación equitativa para ambos bandos"	| atacantes defensoras reinaDefensora |	Transcript		show: 'Iniciando Guerra entre: ' , colonia1 class name , ' y '			, colonia2 class name;		cr.	"Preparar las colecciones de combatientes"	atacantes := colonia1 guerrerasAtacantes asOrderedCollection.	defensoras := colonia2 guerrerasDefensoras asOrderedCollection.	reinaDefensora := colonia2 recuperarReina.	reinaDefensora ifNil: [ ^ self ].	(atacantes isEmpty or: [ defensoras isEmpty ]) ifTrue: [		Transcript			show: 'Guerra no iniciada: listas vacías';			cr.		^ self ].	[ atacantes isNotEmpty and: [ reinaDefensora estaViva ] ] whileTrue: [		| atacante defensora dadoAtacante dadoDefensor |		Transcript			show: 'At:' , atacantes size asString;			cr.		Transcript			show: 'Def:' , defensoras size asString;			cr.		"ROTACIÓN DE ATACANTES: toma el primero y lo quita temporalmente"		atacante := atacantes removeFirst.		"ROTACIÓN DE DEFENSORAS: toma la primera o la reina si no hay"		defensora := defensoras			             ifEmpty: [ reinaDefensora ]			             ifNotEmpty: [ defensoras removeFirst ].		"SIMULAR COMBATE"		dadoAtacante := (1 to: 100) atRandom.		dadoDefensor := (1 to: 100) atRandom.		"CASO 1: Atacante gana"		dadoAtacante > dadoDefensor ifTrue: [			defensora == reinaDefensora				ifTrue: [ "Matar reina" reinaDefensora estaViva: false ]				ifFalse: [ colonia2 matarHormiga: defensora ]. "Matar defensora"			Transcript				show: 'Murió Hormiga Defensora';				cr.			"Atacante sobrevive y vuelve al FINAL de la cola"			atacantes addLast: atacante ].		"CASO 2: Defensor gana"		dadoAtacante < dadoDefensor ifTrue: [			colonia1 matarHormiga: atacante. "Matar atacante"			Transcript				show: 'Murió Hormiga Atacante';				cr.			"Defensora sobrevive (si no es reina) y vuelve al FINAL"			defensora ~= reinaDefensora ifTrue: [				defensoras addLast: defensora ] ].		"CASO 3: Empate"		dadoAtacante = dadoDefensor ifTrue: [ "Ambos sobreviven y vuelven a sus colas"			atacantes addLast: atacante.			defensora ~= reinaDefensora ifTrue: [				defensoras addLast: defensora ] ] ].	"RESOLUCIÓN FINAL"	atacantes isNotEmpty		ifTrue: [ "Victoria atacante: exterminar colonia y tomar botín"			colonia2 exterminarColonia.			colonia1 recibirBotinDe: colonia2 Para: atacantes ]		ifFalse: [ "Victoria defensora: eliminar objetivos de ataque"			colonia1 coloniaObjetivo: nil ].	"Resetear estado de guerra"	colonia1 enGuerra: false.	colonia2 enGuerra: false! !!Mundo methodsFor: 'Propias del tipo' stamp: '2/2/2026 21:16'!verificarGuerras    self coloniasEnGuerra do: [ :colonia |         colonia estaListaParaAtacar ifTrue: [            colonia iniciarGuerraContra: (self buscarColonia: colonia coloniaObjetivo) En: self ] ]! !!Mundo methodsFor: 'Propias del tipo' stamp: '6/25/2025 15:31'!coloniasEnGuerra  |coloniasEnGuerra|  coloniasEnGuerra := OrderedCollection new.  self colonias do:[:colonia|(colonia enGuerra)ifTrue:[coloniasEnGuerra add:colonia]].  ^coloniasEnGuerra ! !!Mundo methodsFor: 'Propias del tipo' stamp: '6/26/2025 22:58'!buscarColonia: unaUbicacion	| casilla |	casilla := (self casillas at: unaUbicacion y) at: unaUbicacion x.	^ casilla! !!Mundo methodsFor: 'Propias del tipo' stamp: '6/25/2025 18:53'!añadirColonia: unaColonia	(self casillas at: unaColonia ubicacion y) at: (unaColonia ubicacion x) put: unaColonia! !!Mundo methodsFor: 'Propias del tipo' stamp: '6/25/2025 19:00'!añadirFuente: unaFuente	(self casillas at: unaFuente ubicacion y)		at: unaFuente ubicacion x		put: unaFuente! !!Mundo methodsFor: 'Propias del tipo' stamp: '2/2/2026 20:48'!finalizarGuerraEntre: atacante Y: defensora conAtacantes: supervivientes    supervivientes isNotEmpty        ifTrue: [             "Victoria Atacante: La reina murió [cite: 131, 133]"            defensora exterminarColonia.             atacante recibirBotinDe: defensora Para: supervivientes.        ]        ifFalse: [             "Victoria Defensora: Se acabaron los atacantes [cite: 105]"            atacante coloniaObjetivo: nil.         ].        atacante enGuerra: false.    defensora enGuerra: false.! !!Mundo methodsFor: 'aux' stamp: '6/25/2025 11:27'!casillaEn: posicion	^ (casillas at: posicion y) at: posicion x! !!Mundo methodsFor: 'user-interface' stamp: '2/2/2026 15:58'!objetoEn: unaUbicacion    "Prioridad 1: Buscar si hay alguna HORMIGA en esta ubicación"    self colonias do: [:colonia |         colonia hormigas do: [:hormiga |             (hormiga ubicacion = unaUbicacion) ifTrue: [ ^hormiga ]        ]    ].    "Prioridad 2: Si no es hormiga, devolver lo que haya en la casilla (Colonia, Fuente o Nada)"    ^ (self casillas at: unaUbicacion y) at: unaUbicacion x! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Mundo class	instanceVariableNames: ''!!Mundo class methodsFor: 'constructor' stamp: '6/26/2025 01:46'!crearConAncho: unAncho Alto: unAlto	"Crea un nuevo mundo con las dimensiones especificadas"	| posicion unMundo grilla |	unMundo := self new.	unMundo ancho: unAncho.	unMundo alto: unAlto.	grilla := (1 to: unAlto) collect: [ :y |		          (1 to: unAncho) collect: [ :x |			          posicion := Point x: x y: y.			          Casilla crearEn: posicion ] ].	unMundo casillas: grilla.	^ unMundo! !SimpleButtonMorph subclass: #BotonAccion	instanceVariableNames: 'mouseAction contenedor'	classVariableNames: ''	package: 'Las Hormigas 2, la secuela new'!!BotonAccion methodsFor: 'accessing' stamp: '2/2/2026 13:47'!mouseAction: unBloque	^mouseAction := unBloque! !!BotonAccion methodsFor: 'event handling' stamp: '2/2/2026 14:20'!mouseUp: unEvento    super mouseUp: unEvento.    mouseAction value! !!BotonAccion methodsFor: 'event handling' stamp: '2/2/2026 14:20'!handlesMouseDown: unEvento    ^true! !BorderedMorph subclass: #CeldaVisual	instanceVariableNames: 'ubicacion mundo'	classVariableNames: ''	package: 'Las Hormigas 2, la secuela new'!!CeldaVisual methodsFor: 'initialization' stamp: '2/2/2026 15:59'!initializeCon: unaUbicacion    super initialize.    ubicacion := unaUbicacion.    self color: Color white.    self borderWidth: 1.    self borderColor: Color gray.    self extent: 20@20.! !!CeldaVisual methodsFor: 'initialization' stamp: '2/2/2026 18:03'!initializeEn: unaUbicacion Con: unMundo	super initialize.	ubicacion := unaUbicacion.	mundo := unMundo.	self color: Color white.	self borderWidth: 1.	self borderColor: Color gray.	self extent: 20 @ 20! !!CeldaVisual methodsFor: 'user-interface' stamp: '2/2/2026 21:30'!dibujar: unObjetoModelo sobre: unFondo	self removeAllMorphs.	self color: Color lightYellow.	(unFondo isKindOf: Colonia) ifTrue: [ self color: Color brown ].	(unFondo isKindOf: FuenteComida) ifTrue: [		unFondo cantidad > 0			ifTrue: [ self color: Color green ]			ifFalse: [ self color: Color lightGreen ] ].	(unObjetoModelo isKindOf: Hormiga) ifTrue: [		self dibujarHormiga: unObjetoModelo ]! !!CeldaVisual methodsFor: 'user-interface' stamp: '2/2/2026 21:30'!dibujarHormiga: unaHormiga	| elipse |	elipse := EllipseMorph new.	elipse extent: self extent * 0.5. "Círculo al 70% del tamaño"	elipse center: self center.	(unaHormiga isMemberOf: Obrera) ifTrue: [ elipse color: Color blue ].	(unaHormiga isMemberOf: Guerrera) ifTrue: [ elipse color: Color red ].	(unaHormiga isMemberOf: Exploradora) ifTrue: [		elipse color: Color black ].	(unaHormiga isMemberOf: Reina) ifTrue: [ elipse color: Color purple ].	self addMorph: elipse! !!CeldaVisual methodsFor: 'user-interface' stamp: '2/2/2026 21:29'!dibujar: unObjetoModelo	self removeAllMorphs.	unObjetoModelo ifNil: [ ^ self color: Color white ].	"1. HORMIGAS"	(unObjetoModelo isKindOf: Hormiga) ifTrue: [		unObjetoModelo estaEnColonia			ifTrue: [ self color: Color brown ]			ifFalse: [ self color: Color white ].		self dibujarHormiga: unObjetoModelo.		^ self ].	"2. COLONIA"	(unObjetoModelo isKindOf: Colonia) ifTrue: [		self color: Color brown.		^ self ].	"3. COMIDA"	(unObjetoModelo isKindOf: FuenteComida) ifTrue: [		unObjetoModelo cantidad > 0			ifTrue: [ self color: Color green ]			ifFalse: [ self color: Color lightGreen ]. 		^ self ].	"4. CASILLA VACÍA"	self color: Color lightYellow! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!CeldaVisual class	instanceVariableNames: ''!!CeldaVisual class methodsFor: 'construction' stamp: '2/2/2026 16:00'!crearEn: unaUbicacion    ^self new initializeCon: unaUbicacion! !!CeldaVisual class methodsFor: 'construction' stamp: '2/2/2026 17:39'!crearEn: unaUbicacion Con:unMundo	^ self new initializeEn: unaUbicacion Con:unMundo! !Casilla subclass: #FuenteComida	instanceVariableNames: 'cantidad'	classVariableNames: ''	package: 'Las Hormigas 2, la secuela new'!!FuenteComida methodsFor: 'accessing' stamp: '6/24/2025 12:00'!cantidad	^ cantidad! !!FuenteComida methodsFor: 'accessing' stamp: '6/24/2025 12:00'!cantidad: anObject	cantidad := anObject! !!FuenteComida methodsFor: 'aux' stamp: '6/24/2025 14:06'!esFuenteDeComida ^true! !!FuenteComida methodsFor: 'aux' stamp: '6/25/2025 20:09'!esCasilla 	^false! !!FuenteComida methodsFor: 'Propias del tipo' stamp: '6/26/2025 22:53'!recolectar	| comida |	comida := 0.	self cantidad >= 3		ifTrue: [			comida := 3.			self cantidad: self cantidad - 3 ]		ifFalse: [			comida := self cantidad.			self cantidad: 0 ].	^ comida! !!FuenteComida methodsFor: 'initialization' stamp: '6/26/2025 22:53'!initialize	super initialize.	cantidad := (1 to: 15) atRandom! !!FuenteComida methodsFor: 'initialization' stamp: '2/2/2026 14:16'!initializeCon: unaUbicacion cantidad: unaCantidad    "Primero inicializamos la ubicación usando el método heredado de Casilla"    self initializeEn: unaUbicacion.        "Luego guardamos la cantidad"    cantidad := unaCantidad.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!FuenteComida class	instanceVariableNames: ''!!FuenteComida class methodsFor: 'construction' stamp: '6/25/2025 16:51'!crear 	^self new		yourself.! !!FuenteComida class methodsFor: 'construction' stamp: '6/25/2025 19:02'!crearEn: unaUbicacion	^ self new	ubicacion: unaUbicacion;	yourself! !Mensaje subclass: #MensajeColonia	instanceVariableNames: ''	classVariableNames: ''	package: 'Las Hormigas 2, la secuela new'!!MensajeColonia methodsFor: 'Propias del tipo' stamp: '6/26/2025 22:56'!procesarMensajePor: unaReina	unaReina estaColoniaEnGuerra		ifTrue: [			unaReina eliminarMensaje.			unaReina añadirMensaje: self ]		ifFalse: [			unaReina darOrdenesAGuerreras: self ubicacion ]! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!MensajeColonia class	instanceVariableNames: ''!!MensajeColonia class methodsFor: 'construction' stamp: '6/25/2025 12:39'!crear: unaCasilla	^ self new initialize: unaCasilla! !Casilla subclass: #Colonia	instanceVariableNames: 'comidaAlmacenada hormigas enGuerra coloniaObjetivo'	classVariableNames: ''	package: 'Las Hormigas 2, la secuela new'!!Colonia methodsFor: 'accessing' stamp: '6/24/2025 11:59'!comidaAlmacenada	^ comidaAlmacenada! !!Colonia methodsFor: 'accessing' stamp: '6/24/2025 11:59'!comidaAlmacenada: anObject	comidaAlmacenada := anObject! !!Colonia methodsFor: 'accessing' stamp: '6/24/2025 11:59'!hormigas	^ hormigas! !!Colonia methodsFor: 'accessing' stamp: '6/24/2025 11:59'!enGuerra	^ enGuerra! !!Colonia methodsFor: 'accessing' stamp: '6/24/2025 11:59'!enGuerra: anObject	enGuerra := anObject! !!Colonia methodsFor: 'accessing' stamp: '6/24/2025 17:47'!hormigas: anObject	hormigas := anObject! !!Colonia methodsFor: 'accessing' stamp: '6/26/2025 02:27'!coloniaObjetivo: anObject	coloniaObjetivo := anObject.! !!Colonia methodsFor: 'accessing' stamp: '6/25/2025 15:04'!coloniaObjetivo	^ coloniaObjetivo! !!Colonia methodsFor: 'Propias del tipo' stamp: '6/26/2025 22:40'!activarRutinaColonial: unMundo	self hormigas do: [ :hormiga |		hormiga consumirComida ifTrue: [ hormiga ejecutarAccion: unMundo ] ]! !!Colonia methodsFor: 'Propias del tipo' stamp: '6/24/2025 16:31'!exterminarColonia  self hormigas do:[:hormiga|self matarHormiga: hormiga]! !!Colonia methodsFor: 'Propias del tipo' stamp: '6/25/2025 19:20'!actualizarComida: unaHormiga	| sePuede |	sePuede := self comidaAlmacenada > 0.	sePuede		ifTrue: [ self comidaAlmacenada: self comidaAlmacenada - 1 ]		ifFalse: [ self matarHormiga: unaHormiga ].	^sePuede.! !!Colonia methodsFor: 'Propias del tipo' stamp: '6/26/2025 23:27'!agregarMensaje: unMensaje	| reina |	reina := self recuperarReina.	reina ifNotNil: [	reina añadirMensaje: unMensaje]! !!Colonia methodsFor: 'Propias del tipo' stamp: '6/26/2025 20:24'!estaListaParaAtacar	^ self guerrerasAtacantes isNotEmpty		and: [ self guerrerasAtacantes allSatisfy: [ :atacante | atacante puedeAtacar ] ]! !!Colonia methodsFor: 'Propias del tipo' stamp: '6/26/2025 22:07'!recuperarReina	^hormigas detect: [:h | h esReina ] ifNone: [ nil ].! !!Colonia methodsFor: 'Propias del tipo' stamp: '6/26/2025 21:55'!recibirBotinDe: unaColonia Para: atacantes	atacantes first mochila: unaColonia comidaAlmacenada.	unaColonia vaciarComida.	atacantes do: [ :atacante |		atacante estado: #regresando.		atacante modo: nil ]! !!Colonia methodsFor: 'aux' stamp: '6/24/2025 23:01'!matarHormiga: unaHormiga  self hormigas: (self hormigas reject: [:h | h == unaHormiga])! !!Colonia methodsFor: 'aux' stamp: '6/26/2025 22:24'!depositarComida: unaComida	self comidaAlmacenada: self comidaAlmacenada + unaComida! !!Colonia methodsFor: 'aux' stamp: '6/24/2025 15:44'!vaciarComida  self comidaAlmacenada: 0! !!Colonia methodsFor: 'aux' stamp: '6/24/2025 13:41'!esColonia  ^true! !!Colonia methodsFor: 'aux' stamp: '6/24/2025 13:42'!esCasilla ^false! !!Colonia methodsFor: 'aux' stamp: '6/26/2025 03:15'!guerreras	| listaGuerreras |	listaGuerreras := OrderedCollection new.	self hormigas do: [ :hormiga |		hormiga esGuerrera ifTrue: [			(hormiga entrenamientoRestante = 0) ifTrue: [				listaGuerreras add: hormiga ] ] ].	^ listaGuerreras! !!Colonia methodsFor: 'aux' stamp: '6/24/2025 13:56'!guerrerasAtacantes  |listaAtacantes|  listaAtacantes := OrderedCollection new.  self guerreras do: [:guerrera | (guerrera modo = #ataque) ifTrue:[listaAtacantes add: guerrera ] ].  ^listaAtacantes ! !!Colonia methodsFor: 'aux' stamp: '6/24/2025 13:57'!guerrerasDefensoras  |listaDefensoras|  listaDefensoras := OrderedCollection new.  self guerreras do: [:guerrera | (guerrera modo = #defensa) ifTrue:[listaDefensoras add: guerrera ] ].  ^listaDefensoras ! !!Colonia methodsFor: 'aux' stamp: '6/24/2025 23:18'!agregarHormiga: unaHormiga  self hormigas add: unaHormiga.  unaHormiga colonia: self! !!Colonia methodsFor: 'aux' stamp: '6/24/2025 23:58'!obreras  |listaObreras|  listaObreras := OrderedCollection new.  self hormigas do: [:hormiga | (hormiga esObrera ) ifTrue:[listaObreras add: hormiga]].  ^listaObreras ! !!Colonia methodsFor: 'initialization' stamp: '6/26/2025 23:18'!initialize	super initialize.	comidaAlmacenada := 200.	hormigas := OrderedCollection new.	enGuerra := false.	coloniaObjetivo := nil! !!Colonia methodsFor: 'as yet unclassified' stamp: '2/2/2026 21:20'!iniciarGuerraContra: unaColoniaDefensora En: unMundo	"Implementa el sistema de combate con rotación equitativa para ambos bandos"	| atacantes defensoras reinaDefensora |	Transcript		show: 'Iniciando Guerra entre: ' , self class name , ' y '			, self class name;		cr.	"Preparar las colecciones de combatientes"	atacantes := self guerrerasAtacantes asOrderedCollection.	defensoras := unaColoniaDefensora guerrerasDefensoras asOrderedCollection.	reinaDefensora := unaColoniaDefensora recuperarReina.	reinaDefensora ifNil: [ ^ self ].	(atacantes isEmpty or: [ defensoras isEmpty ]) ifTrue: [		Transcript			show: 'Guerra no iniciada: listas vacías';			cr.		^ self ].	[ atacantes isNotEmpty and: [ reinaDefensora estaViva ] ] whileTrue: [		| atacante defensora dadoAtacante dadoDefensor |		Transcript			show: 'At:' , atacantes size asString;			cr.		Transcript			show: 'Def:' , defensoras size asString;			cr.		"ROTACIÓN DE ATACANTES: toma el primero y lo quita temporalmente"		atacante := atacantes removeFirst.		"ROTACIÓN DE DEFENSORAS: toma la primera o la reina si no hay"		defensora := defensoras			             ifEmpty: [ reinaDefensora ]			             ifNotEmpty: [ defensoras removeFirst ].		"SIMULAR COMBATE"		dadoAtacante := (1 to: 100) atRandom.		dadoDefensor := (1 to: 100) atRandom.		"CASO 1: Atacante gana"		dadoAtacante > dadoDefensor ifTrue: [			defensora == reinaDefensora				ifTrue: [ "Matar reina" reinaDefensora estaViva: false ]				ifFalse: [ unaColoniaDefensora matarHormiga: defensora ]. "Matar defensora"			Transcript				show: 'Murió Hormiga Defensora';				cr.			"Atacante sobrevive y vuelve al FINAL de la cola"			atacantes addLast: atacante ].		"CASO 2: Defensor gana"		dadoAtacante < dadoDefensor ifTrue: [			self matarHormiga: atacante. "Matar atacante"			Transcript				show: 'Murió Hormiga Atacante';				cr.			"Defensora sobrevive (si no es reina) y vuelve al FINAL"			defensora ~= reinaDefensora ifTrue: [				defensoras addLast: defensora ] ].		"CASO 3: Empate"		dadoAtacante = dadoDefensor ifTrue: [ "Ambos sobreviven y vuelven a sus colas"			atacantes addLast: atacante.			defensora ~= reinaDefensora ifTrue: [				defensoras addLast: defensora ] ] ].	"RESOLUCIÓN FINAL"	atacantes isNotEmpty		ifTrue: [ "Victoria atacante: exterminar colonia y tomar botín"			unaColoniaDefensora exterminarColonia.			self recibirBotinDe: unaColoniaDefensora Para: atacantes ]		ifFalse: [ "Victoria defensora: eliminar objetivos de ataque"			self coloniaObjetivo: nil ].	"Resetear estado de guerra"	self enGuerra: false.	unaColoniaDefensora enGuerra: false! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Colonia class	instanceVariableNames: ''!!Colonia class methodsFor: 'construction' stamp: '6/25/2025 16:49'!crear	^ self new		  yourself.! !!Colonia class methodsFor: 'construction' stamp: '6/25/2025 18:48'!crearEn:unaPosicion	^ self new		ubicacion: unaPosicion;		yourself.! !Object subclass: #Hormiga	instanceVariableNames: 'colonia ubicacion estado'	classVariableNames: ''	package: 'Las Hormigas 2, la secuela new'!!Hormiga methodsFor: 'accessing' stamp: '6/24/2025 12:00'!colonia	^ colonia! !!Hormiga methodsFor: 'accessing' stamp: '6/24/2025 12:00'!colonia: anObject	colonia := anObject! !!Hormiga methodsFor: 'accessing' stamp: '6/24/2025 12:00'!ubicacion	^ ubicacion! !!Hormiga methodsFor: 'accessing' stamp: '6/24/2025 12:00'!estado	^ estado! !!Hormiga methodsFor: 'accessing' stamp: '6/24/2025 12:00'!estado: anObject	estado := anObject! !!Hormiga methodsFor: 'accessing' stamp: '6/26/2025 00:39'!ubicacion: anObject	ubicacion := anObject! !!Hormiga methodsFor: 'Propias del tipo' stamp: '6/24/2025 17:00'!consumirComida  self subclassResponsibility! !!Hormiga methodsFor: 'Propias del tipo' stamp: '6/26/2025 20:56'!esReina ^false! !!Hormiga methodsFor: 'Propias del tipo' stamp: '2/2/2026 17:52'!estaEnFuente: unMundo	| bool |	bool := (unMundo casillaEn: self ubicacion) esFuenteDeComida .	^ bool! !!Hormiga methodsFor: 'aux' stamp: '6/24/2025 13:22'!esGuerrera  ^ false! !!Hormiga methodsFor: 'aux' stamp: '6/24/2025 13:23'!esObrera  ^ false! !!Hormiga methodsFor: 'aux' stamp: '6/24/2025 13:23'!esExploradora  ^ false! !!Hormiga methodsFor: 'aux' stamp: '6/25/2025 23:51'!estaEnColonia	^self ubicacion = self colonia ubicacion! !!Hormiga methodsFor: 'aux' stamp: '6/26/2025 00:30'!volverAColoniaEn: unMundo	| nuevaUbicacion |	nuevaUbicacion := (self		                   calcularMovimientoDesde: self ubicacion		                   Hacia: self colonia ubicacion).	self moverA: nuevaUbicacion En: unMundo.	^ self estaEnColonia! !!Hormiga methodsFor: 'aux' stamp: '6/26/2025 00:39'!moverA: nuevaUbicacion En: unMundo	| casillaDestino |	casillaDestino := unMundo casillaEn: nuevaUbicacion.	self ubicacion: casillaDestino ubicacion.	^ casillaDestino! !!Hormiga methodsFor: 'aux' stamp: '2/2/2026 19:03'!calcularMovimientoDesde: ubicacionActual Hacia: ubicacionDestino	| dx dy siguientePosicion |	dx := (ubicacionDestino x - ubicacionActual x) sign.	dy := (ubicacionDestino y - ubicacionActual y) sign.	siguientePosicion := (ubicacionActual x + dx) @ (ubicacionActual y + dy).	^siguientePosicion! !!Hormiga methodsFor: 'initialization' stamp: '6/26/2025 00:45'!initializeEn: unaUbicacion Con: unaColonia	colonia := unaColonia.	ubicacion := Point x:unaUbicacion x y: unaUbicacion y.	estado := #enColonia! !Hormiga subclass: #Exploradora	instanceVariableNames: 'mensaje ubicacionesConocidas'	classVariableNames: ''	package: 'Las Hormigas 2, la secuela new'!!Exploradora methodsFor: 'accessing' stamp: '6/24/2025 12:00'!mensaje	^ mensaje! !!Exploradora methodsFor: 'accessing' stamp: '6/24/2025 12:00'!mensaje: anObject	mensaje := anObject! !!Exploradora methodsFor: 'accessing' stamp: '6/24/2025 12:00'!ubicacionesConocidas	^ ubicacionesConocidas! !!Exploradora methodsFor: 'accessing' stamp: '6/24/2025 17:47'!ubicacionesConocidas: anObject	ubicacionesConocidas := anObject! !!Exploradora methodsFor: 'Propias del tipo' stamp: '6/24/2025 16:53'!consumirComida   ^true! !!Exploradora methodsFor: 'Propias del tipo' stamp: '6/25/2025 14:12'!ejecutarAccion: unMundoself explorarEn: unMundo! !!Exploradora methodsFor: 'Propias del tipo' stamp: '6/25/2025 23:00'!explorarEn: unMundo	self estado ~= #regresando		ifTrue: [			self estado: nil.			self explorarAleatoriamenteEn: unMundo.			]		ifFalse: [ self volverAColoniaEn: unMundo ]! !!Exploradora methodsFor: 'Propias del tipo' stamp: '2/2/2026 20:36'!explorarAleatoriamenteEn: unMundo	| i nuevaUbicacion direcciones |	i := 1.	direcciones := { 0@ -1. 0@1. 1@0. -1@0. 1@ -1. 1@1. -1@ -1. -1@1 }.	[ i <= 4 and: [ self estado ~= #regresando ] ] whileTrue: [		[		nuevaUbicacion := self ubicacion + direcciones atRandom.		unMundo estaDentroDeLimites: nuevaUbicacion ] whileFalse.		self moverA: nuevaUbicacion En: unMundo.		i := i + 1 ]! !!Exploradora methodsFor: 'Propias del tipo' stamp: '6/25/2025 20:13'!moverA: unaUbicacion En: unMundo	| casilla |	casilla := super moverA: unaUbicacion En: unMundo.	casilla ifNotNil: [ self verificarContenidoCasilla: casilla ]! !!Exploradora methodsFor: 'Propias del tipo' stamp: '2/2/2026 17:36'!verificarContenidoCasilla: unaCasilla    | nuevoMensaje |    nuevoMensaje := nil.        "CORRECCIÓN AQUÍ: Agregamos (and: [ unaCasilla cantidad > 0 ])"    (unaCasilla esFuenteDeComida and: [ unaCasilla cantidad > 0 ])        ifTrue: [ nuevoMensaje := MensajeFuente crear: unaCasilla ]        ifFalse: [            ((unaCasilla esColonia) and: [ unaCasilla ubicacion ~= self colonia ubicacion ])                 ifTrue: [ nuevoMensaje := MensajeColonia crear: unaCasilla ]         ].            nuevoMensaje ifNotNil: [        self estado: #regresando.        self mensaje: nuevoMensaje     ]! !!Exploradora methodsFor: 'Propias del tipo' stamp: '6/25/2025 23:13'!volverAColoniaEn: unMundo	| bool i |	bool := false.	i:=1.	[(i<=4) and:[bool = false]] whileTrue: [		bool := super volverAColoniaEn: unMundo.		i:=i+1.	].	bool ifTrue: [		self estado: #enColonia.		self entregarMensaje ]! !!Exploradora methodsFor: 'Propias del tipo' stamp: '6/25/2025 23:07'!entregarMensaje	self colonia agregarMensaje: self mensaje.	self mensaje: nil! !!Exploradora methodsFor: 'aux' stamp: '6/24/2025 13:32'!esExploradora   ^true! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Exploradora class	instanceVariableNames: ''!!Exploradora class methodsFor: 'constructor' stamp: '6/25/2025 15:56'!crearEn: unaUbicacion De: unaColonia^ self new  initializeEn: unaUbicacion Con: unaColonia;  mensaje: nil;  ubicacionesConocidas: OrderedCollection new;  yourself! !Hormiga subclass: #Guerrera	instanceVariableNames: 'modo ubicacionEnemiga entrenamientoRestante puedeAtacar mochila'	classVariableNames: ''	package: 'Las Hormigas 2, la secuela new'!!Guerrera methodsFor: 'accessing' stamp: '6/24/2025 12:00'!modo	^ modo! !!Guerrera methodsFor: 'accessing' stamp: '6/24/2025 12:00'!modo: anObject	modo := anObject! !!Guerrera methodsFor: 'accessing' stamp: '6/24/2025 12:00'!ubicacionEnemiga	^ ubicacionEnemiga! !!Guerrera methodsFor: 'accessing' stamp: '6/24/2025 12:00'!ubicacionEnemiga: anObject	ubicacionEnemiga := anObject! !!Guerrera methodsFor: 'accessing' stamp: '6/24/2025 12:00'!entrenamientoRestante	^ entrenamientoRestante! !!Guerrera methodsFor: 'accessing' stamp: '6/24/2025 12:00'!entrenamientoRestante: anObject	entrenamientoRestante := anObject! !!Guerrera methodsFor: 'accessing' stamp: '6/24/2025 12:00'!puedeAtacar	^ puedeAtacar! !!Guerrera methodsFor: 'accessing' stamp: '6/24/2025 12:00'!puedeAtacar: anObject	puedeAtacar := anObject! !!Guerrera methodsFor: 'accessing' stamp: '6/24/2025 12:00'!mochila	^ mochila! !!Guerrera methodsFor: 'accessing' stamp: '6/24/2025 12:00'!mochila: anObject	mochila := anObject! !!Guerrera methodsFor: 'Propias del tipo' stamp: '6/24/2025 16:14'!entregarComida  |cantidad |  cantidad:= self mochila.  colonia depositarComida: cantidad.  self mochila: 0! !!Guerrera methodsFor: 'Propias del tipo' stamp: '6/24/2025 16:59'!consumirComida   |result|  result:=(self colonia enGuerra).   result ifFalse: [ result:= (self colonia actualizarComida:self)].  ^result ! !!Guerrera methodsFor: 'Propias del tipo' stamp: '6/26/2025 22:54'!recibirOrden: unaUbicacion	self ubicacionEnemiga: unaUbicacion.	self modo: #ataque! !!Guerrera methodsFor: 'Propias del tipo' stamp: '2/2/2026 21:27'!ejecutarAccion: unMundo    | siguienteUbicacion objetivo distX distY|    self entrenamientoRestante = 0 ifTrue: [        (self modo = #ataque) ifTrue: [            objetivo := unMundo casillaEn: self ubicacionEnemiga.            ((objetivo isKindOf: Colonia) and: [ objetivo hormigas isEmpty ]) ifTrue: [                self modo: nil.                self puedeAtacar: false.                self estado: #regresando.            ]        ].        (self modo = #ataque and: [ self puedeAtacar not ]) ifTrue: [            distX := (self ubicacion x - self ubicacionEnemiga x) abs.            distY := (self ubicacion y - self ubicacionEnemiga y) abs.            (distX max: distY) <= 1                ifTrue: [ self puedeAtacar: true ]                ifFalse: [                    siguienteUbicacion := self calcularMovimientoDesde: self ubicacion Hacia: self ubicacionEnemiga.                    self moverA: siguienteUbicacion En: unMundo                ].        ].        self estado = #regresando ifTrue: [            self volverAColoniaEn: unMundo        ].    ] ifFalse: [        self actualizarEntrenamientoRestante    ].! !!Guerrera methodsFor: 'Propias del tipo' stamp: '6/26/2025 23:20'!volverAColoniaEn: unMundo	| i llegada |	i := 1.	llegada := false.	[ i <= 3 and: [ llegada = false ] ] whileTrue: [		(super volverAColoniaEn: unMundo) ifTrue: [			self entregarComida.			self estado: #enColonia.			llegada := true ].		i := i + 1 ]! !!Guerrera methodsFor: 'aux' stamp: '6/24/2025 13:28'!esGuerrera   ^ true! !!Guerrera methodsFor: 'aux' stamp: '6/24/2025 15:22'!actualizarEntrenamientoRestante  self entrenamientoRestante: (self entrenamientoRestante - 1)! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Guerrera class	instanceVariableNames: ''!!Guerrera class methodsFor: 'constructor' stamp: '6/25/2025 15:56'!crearEn: unaUbicacion De: unaColonia^ self new  initializeEn: unaUbicacion Con: unaColonia;  mochila: 0;  ubicacionEnemiga: nil;  entrenamientoRestante: 2;  puedeAtacar: false;  modo: nil;  yourself! !Hormiga subclass: #Reina	instanceVariableNames: 'comidaComida mensajes estaViva'	classVariableNames: ''	package: 'Las Hormigas 2, la secuela new'!!Reina methodsFor: 'accessing' stamp: '6/24/2025 12:00'!comidaComida	^ comidaComida! !!Reina methodsFor: 'accessing' stamp: '6/24/2025 12:00'!comidaComida: anObject	comidaComida := anObject! !!Reina methodsFor: 'accessing' stamp: '6/24/2025 12:00'!mensajes	^ mensajes! !!Reina methodsFor: 'accessing' stamp: '6/24/2025 12:00'!estaViva	^ estaViva! !!Reina methodsFor: 'accessing' stamp: '6/24/2025 12:00'!estaViva: anObject	estaViva := anObject! !!Reina methodsFor: 'accessing' stamp: '6/24/2025 17:45'!mensajes: anObject	mensajes := anObject! !!Reina methodsFor: 'Propias del tipo' stamp: '6/25/2025 19:32'!consumirComida	| result |	result := self colonia actualizarComida: self.	result ifTrue: [ self comidaComida: comidaComida + 1 ].	result ifFalse: [ self colonia exterminarColonia ].	^ result! !!Reina methodsFor: 'Propias del tipo' stamp: '6/25/2025 21:03'!ejecutarAccion: unMundo	self comidaComida = self class COMIDA_MAXIMA_REINA ifTrue: [		self gestar.		self comidaComida: 0.].	self procesarMensaje! !!Reina methodsFor: 'Propias del tipo' stamp: '6/25/2025 19:48'!gestar	| nuevaHormiga random |	random := (1 to: 10) atRandom.	nuevaHormiga := 		(random between: 1 and: 3) ifTrue: [ self crearObrera ]			ifFalse: [				(random between: 4 and: 5) ifTrue: [ self crearExploradora ]					ifFalse: [						(random between: 6 and: 8) ifTrue: [ self crearGuerrera ]							ifFalse: [ nil ]		]	].nuevaHormiga ifNotNil: [ self colonia agregarHormiga: nuevaHormiga ].! !!Reina methodsFor: 'Propias del tipo' stamp: '6/26/2025 03:47'!procesarMensaje	self mensajes isNotEmpty ifTrue: [		self mensajes do: [ :mensaje |			mensaje isNotNil ifTrue: [				mensaje procesarMensajePor: self ] ] ]! !!Reina methodsFor: 'Propias del tipo' stamp: '6/24/2025 23:37'!designarObrerasNecesarias: unaCantidad  ^unaCantidad/3 ceiling  ! !!Reina methodsFor: 'Propias del tipo' stamp: '6/26/2025 22:34'!darOrdenesA: obrerasNecesarias ObrerasPara: unaUbicacion	| i unaObrera listaObreras |	i := 1.	listaObreras := self colonia obreras.	listaObreras isNotEmpty ifTrue: [		[ i <= obrerasNecesarias and: [ i <= listaObreras size ] ] whileTrue: [			unaObrera := listaObreras at: i.			unaObrera recibirOrden: unaUbicacion.			i := i + 1 ] ].! !!Reina methodsFor: 'Propias del tipo' stamp: '6/25/2025 15:55'!crearObrera    ^ Obrera crearEn: self ubicacion De: self colonia! !!Reina methodsFor: 'Propias del tipo' stamp: '6/25/2025 15:50'!crearExploradora    ^ Exploradora crearEn: self ubicacion De: self colonia! !!Reina methodsFor: 'Propias del tipo' stamp: '6/25/2025 15:55'!crearGuerrera    ^ Guerrera crearEn: self ubicacion De: self colonia! !!Reina methodsFor: 'Propias del tipo' stamp: '6/25/2025 12:39'!eliminarMensaje  self mensajes removeFirst! !!Reina methodsFor: 'Propias del tipo' stamp: '6/26/2025 22:57'!darOrdenesAGuerreras: unaUbicacion	| listaGuerreras i a b |	listaGuerreras := self colonia guerreras.	a := listaGuerreras size - self class MINIMO_ATACANTES.	b := self class MINIMO_DEFENSORES.	a >= b ifTrue: [		i := 1.		listaGuerreras do: [ :guerrera |			i <= Reina MINIMO_ATACANTES				ifTrue: [					guerrera recibirOrden: unaUbicacion.					i := i + 1 ]				ifFalse: [ guerrera modo: #defensa ] ].		self colonia enGuerra: true.		self colonia coloniaObjetivo: unaUbicacion ]! !!Reina methodsFor: 'Propias del tipo' stamp: '6/26/2025 20:55'!esReina	^true! !!Reina methodsFor: 'aux' stamp: '6/24/2025 15:21'!añadirMensaje: unMensaje  self mensajes add: unMensaje  ! !!Reina methodsFor: 'aux' stamp: '6/25/2025 11:37'!estaColoniaEnGuerra  ^self colonia enGuerra ! !!Reina methodsFor: 'initialization' stamp: '6/26/2025 00:33'!initializeEn: unaUbicacion Con: unaColonia	colonia := unaColonia.	ubicacion := unaUbicacion.	estado := #enColonia.	unaColonia agregarHormiga: self! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Reina class	instanceVariableNames: 'COMIDA_MAXIMA_REINA MINIMO_ATACANTES MINIMO_DEFENSORES'!!Reina class methodsFor: 'accessing' stamp: '6/25/2025 19:36'!COMIDA_MAXIMA_REINA	^ 3! !!Reina class methodsFor: 'accessing' stamp: '6/26/2025 03:02'!MINIMO_ATACANTES	^ 3! !!Reina class methodsFor: 'accessing' stamp: '6/26/2025 03:02'!MINIMO_DEFENSORES	^ 1! !!Reina class methodsFor: 'constructor' stamp: '6/25/2025 18:05'!crearEn: unaUbicacion De: unaColonia	^ self new		  initializeEn: unaUbicacion Con: unaColonia;		  comidaComida: 0;		  mensajes: OrderedCollection new;		  estaViva: true;		  yourself! !Hormiga subclass: #Obrera	instanceVariableNames: 'mochila colFuentes'	classVariableNames: ''	package: 'Las Hormigas 2, la secuela new'!!Obrera methodsFor: 'accessing' stamp: '6/24/2025 12:00'!mochila	^ mochila! !!Obrera methodsFor: 'accessing' stamp: '6/24/2025 12:00'!mochila: anObject	mochila := anObject! !!Obrera methodsFor: 'accessing' stamp: '6/24/2025 12:00'!colFuentes	^ colFuentes! !!Obrera methodsFor: 'accessing' stamp: '6/24/2025 17:46'!colFuentes: anObject	colFuentes := anObject! !!Obrera methodsFor: 'Propias del tipo' stamp: '6/24/2025 16:14'!entregarComida  |cantidad |  cantidad:= self mochila.  colonia depositarComida: cantidad.  self mochila: 0! !!Obrera methodsFor: 'Propias del tipo' stamp: '6/24/2025 16:53'!consumirComida  |result|  result := true.  (self estaEnColonia)ifTrue:[ result:=(self colonia actualizarComida: self)] .  ^result! !!Obrera methodsFor: 'Propias del tipo' stamp: '6/25/2025 00:00'!recibirOrden: unaOrden  self colFuentes add: unaOrden! !!Obrera methodsFor: 'Propias del tipo' stamp: '2/2/2026 19:08'!ejecutarAccion: unMundo    | i ubicacion1 ubicacion2 nuevaUbicacion unaCasilla comidaRecolectada |    "Si estoy libre (estado nil) o en la colonia, busco trabajo"    (estado isNil or: [ estado = #enColonia ]) ifTrue: [        ubicacion1 := self ubicacion.                colFuentes isNotEmpty ifTrue: [            i := 1.            ubicacion2 := colFuentes first. "El destino actual"                        "1. CAMINAR HACIA LA FUENTE (Máximo 3 pasos)"            [ ubicacion1 ~= ubicacion2 and: [ i <= 3 ] ] whileTrue: [                nuevaUbicacion := self calcularMovimientoDesde: ubicacion1 Hacia: ubicacion2.                unaCasilla := self moverA: nuevaUbicacion En: unMundo.                ubicacion1 := unaCasilla ubicacion.                i := i + 1 .            ].            "2. VERIFICAR LLEGADA"            ubicacion1 = ubicacion2 ifTrue: [                "Intentamos recolectar"                comidaRecolectada := unaCasilla recolectar.                self mochila: comidaRecolectada.                                "----- CORRECCIÓN AQUÍ -----"                comidaRecolectada = 0 ifTrue: [                    "SI LA FUENTE ESTA VACIA (0):"                    Transcript show: 'Fuente vacia en ', ubicacion2 asString; cr.                                        "A. Borramos TODAS las ordenes que apunten a este lugar muerto"                    colFuentes removeAllSuchThat: [:destino | destino = ubicacion2].                                        "B. Decidimos qué hacer ahora"                    colFuentes isNotEmpty                         ifTrue: [                             "Si tengo otra fuente en lista, me quedo en estado 'listo' para ir a la proxima en el sig turno"                            self estado: #enColonia.                         ]                        ifFalse: [                             "Si no tengo mas trabajo, vuelvo a casa"                            self estado: #regresando.                         ].                ]                 ifFalse: [                    "SI HAY COMIDA: Vuelvo a llevarla"                    self estado: #regresando.                ].            ]        ]    ] ifFalse: [         "Si estoy regresando, sigo mi camino a casa"        self volverAColoniaEn: unMundo     ].! !!Obrera methodsFor: 'Propias del tipo' stamp: '2/2/2026 18:03'!volverAColoniaEn: unMundo    | paso i llego |    paso := 3. "Velocidad por defecto (sin comida)"    i := 1.    llego := false.        "CORRECCIÓN AQUÍ: Si mochila > 0, pesa y va lento"    self mochila > 0 ifTrue: [ paso := 1 ].         [ i <= paso and: [ llego = false ] ] whileTrue: [        (super volverAColoniaEn: unMundo) ifTrue: [            self entregarComida.            llego := true.            self estado: #enColonia         ].        i := i + 1     ].! !!Obrera methodsFor: 'aux' stamp: '6/24/2025 13:32'!esObrera   ^true! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Obrera class	instanceVariableNames: ''!!Obrera class methodsFor: 'constructor' stamp: '6/25/2025 15:57'!crearEn: unaUbicacion De: unaColonia^ self new  initializeEn: unaUbicacion Con: unaColonia;  mochila: 0;  colFuentes: OrderedCollection new;  yourself! !Object subclass: #Simulacion	instanceVariableNames: 'mundo turnoActual'	classVariableNames: ''	package: 'Las Hormigas 2, la secuela new'!!Simulacion methodsFor: 'accessing' stamp: '6/24/2025 12:01'!mundo	^ mundo! !!Simulacion methodsFor: 'accessing' stamp: '6/24/2025 12:01'!mundo: anObject	mundo := anObject! !!Simulacion methodsFor: 'accessing' stamp: '6/24/2025 12:01'!turnoActual	^ turnoActual! !!Simulacion methodsFor: 'accessing' stamp: '6/24/2025 12:01'!turnoActual: anObject	turnoActual := anObject! !!Simulacion methodsFor: 'Propios del tipo' stamp: '2/2/2026 19:08'!ejecutarTurno    Transcript show: 'Turno: ', self turnoActual asString; cr.    self mundo iniciarMundo.    self turnoActual: turnoActual + 1.! !!Simulacion methodsFor: 'Propios del tipo' stamp: '2/2/2026 14:04'!agregarFuenteComidaEn: unaUbicacion cantidad: cantidadComida    | fuente |    fuente := FuenteComida new initializeCon: unaUbicacion cantidad: cantidadComida.    self mundo añadirFuente: fuente.    ^ fuente! !!Simulacion methodsFor: 'Propios del tipo' stamp: '2/2/2026 14:20'!agregarColoniaEn: unaUbicacion conComida: cantidadComida cantidadHormigas: cantidadHormigas    | colonia nuevaHormiga |        "1. Crear la colonia"    colonia := Colonia new               ubicacion: unaUbicacion;               comidaAlmacenada: cantidadComida;               yourself.        "2. AGREGAR LAS HORMIGAS (Esto faltaba)"    "Agregamos una Reina primero (opcional, pero recomendado)"    colonia agregarHormiga: (Reina crearEn: unaUbicacion De: colonia).        "Agregamos las Obreras segun la cantidad pedida"    cantidadHormigas timesRepeat: [        nuevaHormiga := Obrera crearEn: unaUbicacion De: colonia.        colonia agregarHormiga: nuevaHormiga.    ].    "3. Guardar en el mundo"    self mundo añadirColonia: colonia.! !BorderedMorph subclass: #Contador	instanceVariableNames: 'turno unaSimulacion'	classVariableNames: ''	package: 'Las Hormigas 2, la secuela new'!!Contador methodsFor: 'initialization' stamp: '2/2/2026 20:00'!initialize	super initialize.	self		extent: 40 @ 40;		color: Color lightGray ;		borderWidth: 1;		borderColor: Color white ;		layoutPolicy: TableLayout new;		hResizing: #shrinkWrap;		vResizing: #shrinkWrap.	turno := StringMorph contents: '1'.	self addMorph: turno! !!Contador methodsFor: 'accessing' stamp: '2/2/2026 18:42'!turno	^turno ! !!Contador methodsFor: 'accessing' stamp: '2/2/2026 19:49'!turno: unTurno	turno := unTurno! !!Contador methodsFor: 'accessing' stamp: '2/2/2026 19:49'!unaSimulacion: simulacion	unaSimulacion := simulacion! !!Contador methodsFor: 'accessing' stamp: '2/2/2026 19:44'!unaSimulacion ^unaSimulacion! !!Contador methodsFor: 'stepping and presenter' stamp: '2/2/2026 20:33'!step	| valorActual |	valorActual := unaSimulacion turnoActual asString.	turno contents = valorActual ifFalse: [ turno contents: valorActual ]! !!Contador methodsFor: 'stepping and presenter' stamp: '2/2/2026 19:49'!stepTime	^ 100! !Mensaje subclass: #MensajeFuente	instanceVariableNames: 'cantidad'	classVariableNames: ''	package: 'Las Hormigas 2, la secuela new'!!MensajeFuente methodsFor: 'accessing' stamp: '6/24/2025 12:00'!cantidad	^ cantidad! !!MensajeFuente methodsFor: 'accessing' stamp: '6/24/2025 12:00'!cantidad: anObject	cantidad := anObject! !!MensajeFuente methodsFor: 'aux' stamp: '6/24/2025 14:07'!esMensajeColonia   ^false! !!MensajeFuente methodsFor: 'initialization' stamp: '6/25/2025 12:56'!initialize: unaCasilla	super initialize: unaCasilla.	cantidad := unaCasilla cantidad.! !!MensajeFuente methodsFor: 'Propias del tipo' stamp: '2/2/2026 17:42'!procesarMensajePor: unaReina    | obrerasNecesarias |        "1. Calcular y dar las órdenes (esto ya estaba)"    obrerasNecesarias := unaReina designarObrerasNecesarias: self cantidad.    unaReina darOrdenesA: obrerasNecesarias ObrerasPara: self ubicacion.        "2. CORRECCIÓN CLAVE: Borrar el mensaje del buzón de la reina"    "Si no hacemos esto, la reina leerá este mismo mensaje eternamente"    unaReina mensajes remove: self ifAbsent: [].! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!MensajeFuente class	instanceVariableNames: ''!!MensajeFuente class methodsFor: 'construction' stamp: '6/25/2025 12:56'!crear: unaCasilla	^ self new		  initialize: unaCasilla;		  yourself! !